// UIAlertViewDelegate Block typedefs

typedef void (^AlertViewClickedButtonAtIndexBlock)(UIAlertView *alertView, NSInteger buttonIndex);
typedef void (^AlertViewCancelBlock)(UIAlertView *alertView);
typedef void (^WillPresentAlertViewBlock)(UIAlertView *alertView);
typedef void (^DidPresentAlertViewBlock)(UIAlertView *alertView);
typedef void (^AlertViewWillDismissWithButtonIndexBlock)(UIAlertView *alertView, NSInteger buttonIndex);
typedef void (^AlertViewDidDismissWithButtonIndexBlock)(UIAlertView *alertView, NSInteger buttonIndex);
typedef BOOL (^AlertViewShouldEnableFirstOtherButtonBlock)(UIAlertView *alertView);

#pragma mark - UIAlertViewDelegate Block setter definitions

- (instancetype)setAlertViewClickedButtonAtIndexBlock:(AlertViewClickedButtonAtIndexBlock)block;
- (instancetype)setAlertViewCancelBlock:(AlertViewCancelBlock)block;
- (instancetype)setWillPresentAlertViewBlock:(WillPresentAlertViewBlock)block;
- (instancetype)setDidPresentAlertViewBlock:(DidPresentAlertViewBlock)block;
- (instancetype)setAlertViewWillDismissWithButtonIndexBlock:(AlertViewWillDismissWithButtonIndexBlock)block;
- (instancetype)setAlertViewDidDismissWithButtonIndexBlock:(AlertViewDidDismissWithButtonIndexBlock)block;
- (instancetype)setAlertViewShouldEnableFirstOtherButtonBlock:(AlertViewShouldEnableFirstOtherButtonBlock)block;

// UIAlertViewDelegate Block keys

static char AlertViewClickedButtonAtIndexKey;
static char AlertViewCancelKey;
static char WillPresentAlertViewKey;
static char DidPresentAlertViewKey;
static char AlertViewWillDismissWithButtonIndexKey;
static char AlertViewDidDismissWithButtonIndexKey;
static char AlertViewShouldEnableFirstOtherButtonKey;

#pragma mark - UIAlertViewDelegate Block setters

- (instancetype)setAlertViewClickedButtonAtIndexBlock:(AlertViewClickedButtonAtIndexBlock)block
{
  objc_setAssociatedObject(self, &AlertViewClickedButtonAtIndexKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setAlertViewCancelBlock:(AlertViewCancelBlock)block
{
  objc_setAssociatedObject(self, &AlertViewCancelKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setWillPresentAlertViewBlock:(WillPresentAlertViewBlock)block
{
  objc_setAssociatedObject(self, &WillPresentAlertViewKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setDidPresentAlertViewBlock:(DidPresentAlertViewBlock)block
{
  objc_setAssociatedObject(self, &DidPresentAlertViewKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setAlertViewWillDismissWithButtonIndexBlock:(AlertViewWillDismissWithButtonIndexBlock)block
{
  objc_setAssociatedObject(self, &AlertViewWillDismissWithButtonIndexKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setAlertViewDidDismissWithButtonIndexBlock:(AlertViewDidDismissWithButtonIndexBlock)block
{
  objc_setAssociatedObject(self, &AlertViewDidDismissWithButtonIndexKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setAlertViewShouldEnableFirstOtherButtonBlock:(AlertViewShouldEnableFirstOtherButtonBlock)block
{
  objc_setAssociatedObject(self, &AlertViewShouldEnableFirstOtherButtonKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

#pragma mark - UIAlertViewDelegate

- (void) alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
  ^(AlertViewClickedButtonAtIndexBlock block) {
    if (block)
      block(alertView, buttonIndex);
  } (objc_getAssociatedObject(self, &AlertViewClickedButtonAtIndexKey));
}

- (void) alertViewCancel:(UIAlertView *)alertView
{
  ^(AlertViewCancelBlock block) {
    if (block)
      block(alertView);
  } (objc_getAssociatedObject(self, &AlertViewCancelKey));
}

- (void) willPresentAlertView:(UIAlertView *)alertView
{
  ^(WillPresentAlertViewBlock block) {
    if (block)
      block(alertView);
  } (objc_getAssociatedObject(self, &WillPresentAlertViewKey));
}

- (void) didPresentAlertView:(UIAlertView *)alertView
{
  ^(DidPresentAlertViewBlock block) {
    if (block)
      block(alertView);
  } (objc_getAssociatedObject(self, &DidPresentAlertViewKey));
}

- (void) alertView:(UIAlertView *)alertView willDismissWithButtonIndex:(NSInteger)buttonIndex
{
  ^(AlertViewWillDismissWithButtonIndexBlock block) {
    if (block)
      block(alertView, buttonIndex);
  } (objc_getAssociatedObject(self, &AlertViewWillDismissWithButtonIndexKey));
}

- (void) alertView:(UIAlertView *)alertView didDismissWithButtonIndex:(NSInteger)buttonIndex
{
  ^(AlertViewDidDismissWithButtonIndexBlock block) {
    if (block)
      block(alertView, buttonIndex);
  } (objc_getAssociatedObject(self, &AlertViewDidDismissWithButtonIndexKey));
}

- (BOOL) alertViewShouldEnableFirstOtherButton:(UIAlertView *)alertView
{
  return ^(AlertViewShouldEnableFirstOtherButtonBlock block) {
    return (block) ? block(alertView) : NO;
  } (objc_getAssociatedObject(self, &AlertViewShouldEnableFirstOtherButtonKey));
}

