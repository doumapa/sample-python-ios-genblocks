// UIPickerViewDelegate Block typedefs

typedef CGFloat (^PickerViewWidthForComponentBlock)(UIPickerView *pickerView, NSInteger component);
typedef CGFloat (^PickerViewRowHeightForComponentBlock)(UIPickerView *pickerView, NSInteger component);
typedef NSString* (^PickerViewTitleForRowForComponentBlock)(UIPickerView *pickerView, NSInteger row, NSInteger component);
typedef NSAttributedString* (^PickerViewAttributedTitleForRowForComponentBlock)(UIPickerView *pickerView, NSInteger row, NSInteger component);
typedef id (^PickerViewViewForRowForComponentReusingViewBlock)(UIPickerView *pickerView, NSInteger row, NSInteger component, id view);
typedef void (^PickerViewDidSelectRowInComponentBlock)(UIPickerView *pickerView, NSInteger row, NSInteger component);

#pragma mark - UIPickerViewDelegate Block setter definitions

- (instancetype)setPickerViewWidthForComponentBlock:(PickerViewWidthForComponentBlock)block;
- (instancetype)setPickerViewRowHeightForComponentBlock:(PickerViewRowHeightForComponentBlock)block;
- (instancetype)setPickerViewTitleForRowForComponentBlock:(PickerViewTitleForRowForComponentBlock)block;
- (instancetype)setPickerViewAttributedTitleForRowForComponentBlock:(PickerViewAttributedTitleForRowForComponentBlock)block;
- (instancetype)setPickerViewViewForRowForComponentReusingViewBlock:(PickerViewViewForRowForComponentReusingViewBlock)block;
- (instancetype)setPickerViewDidSelectRowInComponentBlock:(PickerViewDidSelectRowInComponentBlock)block;

// UIPickerViewDelegate Block keys

static char PickerViewWidthForComponentKey;
static char PickerViewRowHeightForComponentKey;
static char PickerViewTitleForRowForComponentKey;
static char PickerViewAttributedTitleForRowForComponentKey;
static char PickerViewViewForRowForComponentReusingViewKey;
static char PickerViewDidSelectRowInComponentKey;

#pragma mark - UIPickerViewDelegate Block setters

- (instancetype)setPickerViewWidthForComponentBlock:(PickerViewWidthForComponentBlock)block
{
  objc_setAssociatedObject(self, &PickerViewWidthForComponentKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setPickerViewRowHeightForComponentBlock:(PickerViewRowHeightForComponentBlock)block
{
  objc_setAssociatedObject(self, &PickerViewRowHeightForComponentKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setPickerViewTitleForRowForComponentBlock:(PickerViewTitleForRowForComponentBlock)block
{
  objc_setAssociatedObject(self, &PickerViewTitleForRowForComponentKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setPickerViewAttributedTitleForRowForComponentBlock:(PickerViewAttributedTitleForRowForComponentBlock)block
{
  objc_setAssociatedObject(self, &PickerViewAttributedTitleForRowForComponentKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setPickerViewViewForRowForComponentReusingViewBlock:(PickerViewViewForRowForComponentReusingViewBlock)block
{
  objc_setAssociatedObject(self, &PickerViewViewForRowForComponentReusingViewKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

- (instancetype)setPickerViewDidSelectRowInComponentBlock:(PickerViewDidSelectRowInComponentBlock)block
{
  objc_setAssociatedObject(self, &PickerViewDidSelectRowInComponentKey, block, OBJC_ASSOCIATION_COPY);
  return self;
}

#pragma mark - UIPickerViewDelegate

- (CGFloat) pickerView:(UIPickerView *)pickerView widthForComponent:(NSInteger)component
{
  return ^(PickerViewWidthForComponentBlock block) {
    return (block) ? block(pickerView, component) : 0;
  } (objc_getAssociatedObject(self, &PickerViewWidthForComponentKey));
}

- (CGFloat) pickerView:(UIPickerView *)pickerView rowHeightForComponent:(NSInteger)component
{
  return ^(PickerViewRowHeightForComponentBlock block) {
    return (block) ? block(pickerView, component) : 0;
  } (objc_getAssociatedObject(self, &PickerViewRowHeightForComponentKey));
}

- (NSString *) pickerView:(UIPickerView *)pickerView titleForRow:(NSInteger)row forComponent:(NSInteger)component
{
  return ^(PickerViewTitleForRowForComponentBlock block) {
    return (block) ? block(pickerView, row, component) : @"";
  } (objc_getAssociatedObject(self, &PickerViewTitleForRowForComponentKey));
}

- (NSAttributedString *) pickerView:(UIPickerView *)pickerView attributedTitleForRow:(NSInteger)row forComponent:(NSInteger)component
{
  return ^(PickerViewAttributedTitleForRowForComponentBlock block) {
    return (block) ? block(pickerView, row, component) : nil;
  } (objc_getAssociatedObject(self, &PickerViewAttributedTitleForRowForComponentKey));
}

- (id) pickerView:(UIPickerView *)pickerView viewForRow:(NSInteger)row forComponent:(NSInteger)component reusingView:(id)view
{
  return ^(PickerViewViewForRowForComponentReusingViewBlock block) {
    return (block) ? block(pickerView, row, component, view) : nil;
  } (objc_getAssociatedObject(self, &PickerViewViewForRowForComponentReusingViewKey));
}

- (void) pickerView:(UIPickerView *)pickerView didSelectRow:(NSInteger)row inComponent:(NSInteger)component
{
  ^(PickerViewDidSelectRowInComponentBlock block) {
    if (block)
      block(pickerView, row, component);
  } (objc_getAssociatedObject(self, &PickerViewDidSelectRowInComponentKey));
}

